\chapter{Introduction}
\label{chap:intro}
\begin{itemize}
\item this is not finished!! (not event close to being so)
\item motivate interesting thermodynamical questions and the advantage
  of the NMQSD/HOPS in this case without repeating \cref{sec:ergo_general}
\end{itemize}

The exact treatment of strongly coupled and non Markovian open quantum
systems is a challenging problem.  If no analytical solution is
available, numerical methods have to be relied upon. Notably there are
HEOM\fixme{cite more}.

Besides the reduced dynamics of the system, the field of quantum
thermodynamics has attracted much interest. Quantum thermodynamics is,
among other issues, concerned with extending the standard
phenomenological thermodynamic notions to microscopic systems coupled
to macroscopic baths. This setting may make it possible to make
rigorous microscopic definitions of thermodynamic quantities such as
internal energy, heat and work that are consistent with the laws of
thermodynamics. There is no consensus on this matter yet, as is
demonstrated by the plethora of proposals and discussions in
\cite{Rivas2019Oct,Talkner2020Oct,Motz2018Nov,Wiedmann2020Mar,Senior2020Feb,Kato2015Aug,Kato2016Dec,Strasberg2021Aug,Talkner2016Aug,Bera2021Feb,Bera2021Jun,Esposito2015Dec}.

As system and baths may not be regarded as completely separable
entities in a strong coupling
regime~\cite{Rivas2019Oct,Esposito2015Dec}, an insight into the
dynamics of the bath is crucial. In some settings
\cite{Kato2016Dec,Lobejko2021Feb, Strasberg2021Aug}, such as cyclic
heat engines, the change in the bath energies is a quite suitable
definition of heat, as is expounded in
\cref{sec:basic_thermo,sec:operational_thermo}.

As it turns out, the framework of the ``Non Markovian State
Diffusion'' (NMQSD)~\cite{Diosi1998Mar}, which will be reviewed
in~\cref{sec:open_systems}, allows access to certain bath related
observables such as the time derivative of the bath energy expectation
value and the interaction Hamiltonian expectation value. The

In \cref{sec:basic_thermo}, some operational quantum thermodynamical
questions will be discussed and some light will be shed on the
necessity of infinite baths.

\Cref{chap:flow} presents the main result of this thesis, namely
formulas to calculate expectation values of bath related
observables. Finally, we will discuss some numerical applications of
the result in \cref{chap:numres}. These application include a
\fixme{references}.

In \cref{chap:hops_notes}, some HOPS related subjects are discussed,
including a derivation of the HOPS for multiple baths embedded in an
auxiliary bosonic Fock space in \cref{sec:multihops}.

\newpage

\section{Open Quantum Systems}
\label{sec:open_systems}
Quantum physics' most important equation, the Schr\"odinger equation,
allows us to predict the future of a system knowing its initial
state. Writing it down
\begin{equation}
  \label{eq:schroedinger}
  \iu ∂_{t} \ket{ψ(t)} = H \ket{ψ(t)},
\end{equation}
we find that we need to specify a \emph{Hamiltonian} \(H\) that acts
on our system state which is an element of a Hilbert space of some
dimension \(N\). Throughout the work we set \(\hbar=c=1\).

We call the time evolution generated by \cref{eq:schroedinger}
\emph{Unitary}, as it preserves the norm of a state and is reversible.
Given any time independent Hamiltonian we may write down the time
evolution operator to solve the Schr\"odinger equation
\begin{equation}
  \label{eq:time_evo_op}
  U(t, t_{0})=\eu^{-\iu H (t-t_{0})},\; U(t, t_{0})^\dag U(t, t_{0}) =
  \id,\; U\ket{ψ(t_{0})} = \ket{ψ(t)}.
\end{equation}

For time independent Hamiltonians the Schr\"odinger equation describes
a closed system which constitutes, within the scope of the problem in
question, the whole universe. In general, it is very hard to find a
closed expression for \cref{eq:time_evo_op}, except for very special
cases. Either one takes to approximations or one applies numerical
methods to solve \cref{eq:schroedinger}.

When the Hilbert space dimension is small, its numerical solution is
straight forward. But in more realistic scenarios we may still be
interested in a small system, but we cannot neglect the interaction of
that system with a much larger environment sometimes consisting of
infinite degrees of freedom. If the atmosphere of the earth would be
neglected when describing the descent of a space reentry capsule we
would arrive at fatally wrong results. Similarly, modern applications
of quantum physics deal with systems that undergo quantum evolution
under conditions that are not consistent with an isolated
system. Specifically in quantum computing~\cite{Gill2022Jan} the
effect of environmental interactions poses a major problem.

As a classical example, stokes drag models the influence of a viscous
fluid on spherical objects and can be implemented by adding a velocity
dependent term to the equation of motion of our object,
\begin{equation}
  \label{eq:newton}
  \ddot{x} = F - α \dot{x}.
\end{equation}
We still retain all information about the system, the particle, having
accounted effectively for an environment, the fluid.

In quantum physics, we find that the situation is more complicated.
Writing down a Hamiltonian we have to account for both system and
environment in a composite Hilbert space \(\hilb=\hilb_{\sys}\otimes\hilb_{\bath}\)
\begin{equation}
  \label{eq:general_open}
  H = H_{\sys} \otimes \id_{\bath} + \id_{\sys} \otimes H_{\bath} + H_{\inter},
\end{equation}
where \(\sys\) marks the system, \(\bath\) marks the environment (or
bath) and \(H_{\inter}\) models the environment.

Although the global state of system and environment may be pure,
entanglement of system and environment leads to the effect, that we
may know the system state only as a statistical mixture of states
called the \emph{reduced state}. No part of a composite system may be
in general be known as ``precicely'' as the whole.

Starting from a possibly mixed global state \(ρ(t)\) we find, that to
find the dynamics of all observables \(O_{\sys}\) that only act on the
system Hilbert space it is sufficient to know
\(ρ_{\sys}(t)=\tr_{\bath}[ρ(t)]\), the reduced system state.

The partial trace \(\tr_{\bath}\) averages over all bath degrees of
freedom and removes them from explicit consideration. This is a most
useful device, as the environment usually has a Hilbert space
dimension that is much too large for practical
calculations. Especially in numerically this fact is important, as
even an environment consisting of \(50\) two level systems would
consume \(128\) tebibyte of memory when stored as double precision
floating point numbers.

Under certain assumptions, most importantly that of weak coupling
\(\ev{H_{\inter}}\approx 0\), a pertubative treatment of the
environment yields an evolution equation, called a \emph{master
  equation}, that only contains the system state
\(ρ_{\sys}\)~\cite[p. 115 ff.]{Breuer2002Jun,Rivas2012}. This equation
often called Gorini–Kossakowski–Sudarshan–Lindblad equation, or GKSL
equation in short, leads to irreversible non unitary dynamics and has
the form
\begin{equation}
  \label{eq:gksl}
  \dot{ρ}_{\sys} = -\iu \comm{H}{ρ_{\sys}} + \mathcal{D}[ρ_{\sys}] = \mathcal{L}[ρ_{\sys}],
\end{equation}
where \(\mathcal{D}\) is called the \emph{dissipator} which adds
non-unitary dynamics to the von Neumann equation and \(H\) is a
unitary contribution not necessarily equal to \(H_{\sys}\).

Integrating \cref{eq:gksl} leads to a map
\(ρ_{\sys}(t) = \mathcal{E}_{t}(ρ_{\sys}(0))\).  The evolution
generated \cref{eq:gksl} is called Markovian, as
\(\mathcal{E}_{t+s}= \mathcal{E}_{t}\circ\mathcal{E}_{s}\). More
fundamentally, this due to the fact that one at some point assumes,
that the bath has no ``memory''\footnote{This does not mean that the global
state has always the form \(ρ_{\sys}(t)\otimes
ρ_{\bath}(t)\)~\cite{Rivas2012}.}. Without getting into the details,
one may say that the characteristic time scales upon which correlation
functions of bath observables decay should be much smaller than the
time scales of the system.

If one endeavors to drop the assumptions of weak coupling and of
Markovian dynamics, the situation becomes more complicated. But when
introducing a concrete model of the bath we find that
\cref{eq:schroedinger} can be recast into a form that allows for an
exact numerical solution. The great advantage from the standpoint of
this thesis is, that although we solve for the reduced state
\(ρ_{\sys}\), we essentially calculate the unitary dynamics of system
and bath retain some information about the bath. This allows to
quantify the change in expected bath energy and also the expectation
value of the interaction Hamiltonian.

\Cref{sec:nmqsd_basics} will introduce the general model whose
solution will be made feasible with the introduction of the \emph{Non
  Markovian Quantum State Diffusion} (NMQSD). The numerical
implementation of the NMQSD, the \emph{Hierarch of Pure States}
(HOPS), will be the topic of \cref{sec:hops_basics}.

A more detailed account of both subjects can be found in
\cref{sec:multihops} as well as \cite{RichardDiss}.


The basics of the NMQSD will be briefly reviewed in
\cref{sec:nmqsd_basics} as will the basics of HOPS in
\cref{sec:hops_basics}.

\section{The Non Markovian Quantum State Diffusion}
\label{sec:nmqsd_basics}

We will now introduce the fundamental form of the models that will be
discussed in this thesis. This model has a wide applicability and many
microscopic systems can be cast into its form
\cite{Strunz2001Habil}\cite[chap. 2]{RichardDiss}, although there
certainly exist limits of applicability~\cite{Caldeira2014Mar}.

Consider a general quantum system \(H_\sys(t)\) coupled to \(N\) baths
of harmonic oscillators\footnote{For instance, the electromagnetic field.}
\begin{equation}
  \label{eq:generalmodel}
  H(t) = H_\sys(t) + ∑_{n=1}^N \qty[L_n^†(t)B_n + \hc] + ∑_{n=1}^NH_B\nth ,
\end{equation}
with \(B_n=∑_{λ} g_λ\nth a_λ\nth\) and
\(H_B\nth=∑_λω_λ\nth \qty(a_λ\nth)^\dag a_λ\nth\). The \(a_λ\) are
bosonic annihilation operators and the \(L_n\) are arbitrary not
necessarily hermitian operators system Hilbert space.

Despite the simple structure of the baths, \cref{eq:generalmodel} is
generally very hard to solve beyond weak coupling strengths as has
been detailed in~\cref{sec:open_systems}. The ``Non Markovian Quantum
State Diffusion'' (NMQSD)~\cite{Diosi1998Mar} approach allows to
recast \cref{eq:generalmodel} into a stochastic differential equation
in which the bath degrees of freedom are accounted for by Gaussian
stochastic processes.

Here we only consider a single zero temperature bath initially in the
ground state \(\ket{0}\). For more complete and general account see
\cite{RichardDiss,Strunz2001Habil,Diosi1998Mar,Hartmann2017Dec} and
\cref{sec:hops_multibath}.

The total system-bath state may then be expanded in a Bargmann
coherent state basis~\cite{klauder1968fundamentals} with respect to
the bath degrees of freedom
\begin{equation}
  \label{eq:projected_single}
  \ket{ψ(t)} = ∫{\frac{\dd{\vb{z}}}{π^{N}}\eu^{-\abs{\vb{z}}^2}}\ket{ψ(t,\vb{z}^\ast)}\ket{\vb{z}},
\end{equation}
where \(\vb{z}\) is a vector of coherent state labels \(z_λ\) for each
environment oscillator. The \(\ket{ψ(t,\vb{z})^{\ast}}\) are
holomorphic functions of \(\vb{z}^\ast\).


After transforming \cref{eq:generalmodel} into the interaction picture
with respect to \(H_B\) and using the properties of the coherent
states (\(\mel{z_λ}{a_λ}{ψ}\rightarrow ∂_{z_λ^\ast}\braket{z_λ}{ψ}\),
\(\mel{z_λ}{a_λ^\dag}{ψ}\rightarrow z_λ^\ast\braket{z_λ}{ψ}\)) we
arrive at an equation for \(\ket{ψ(t,\vb{z}^{\ast})}\)
\begin{equation}
  \label{eq:nmqsd_single_proto}
  ∂_t\ket{ψ(t,\vb{z}^{\ast})} = -\iu H \ket{ψ(t,\vb{z}^{\ast})} - \iu
  L ∑_{λ}g_{λ}^\ast z_{λ}^\ast \eu^{\iu ω_{λ} t}
  \ket{ψ(t,\vb{z}^{\ast})} - \iu L^\dag ∑_{λ} g_{λ}\eu^{-\iu ω_{λ} t}\pdv{}{z_{λ}^\ast}\ket{ψ(t,\vb{z}^{\ast})}.
\end{equation}

From this point on there are multiple avenues to continue. We choose
the simplest one, but there is also a time-discrete derivation that
avoids functional derivatives in~\cite{Hartmann2017Dec}.

We shift the perspective and define
\begin{equation}
  \label{eq:single_process}
  η^\ast_{t} = -\iu ∑_λg_λ^{\ast} z_λ^{\ast}\eu^{\iu ω_λ t},
\end{equation}
using
\(\pdv{z_λ^{\ast}}=∫\dd{s}\pdv{η^\ast_{s}}{z_λ^{\ast}}\fdv{η^\ast_{s}}\)
and interpreting \(\ket{ψ(t,\vb{z}^{\ast})}\) as a functional of
\(η_{t}^\ast\) we arrive at
\begin{equation}
  \label{eq:nmqsd_single}\tag{NMQSD}
  ∂_tψ_t(η^\ast_t) = -\iu H ψ_t(η^\ast_t) +
  L {η}^\ast_tψ_t({η}^\ast_t) - L^†∫_0^t\dd{s}α(t-s)\fdv{ψ_t({η}^\ast_t)}{η^\ast_s},
\end{equation}
where \(α\) is the zero temperature bath correlation function (BCF)
\begin{equation}
  \label{eq:bcfdef}
  α(t-s) = \ev{B(t)B(s)} = ∑_λ \abs{g_λ}^2\eu^{-\iu ω_λ (t-s)}
\end{equation}
and \(η_t\) is a Gaussian stochastic process obeying
\begin{equation}
  \label{eq:single_processescorr}
  \begin{aligned}
      \mathcal{M}(η_t) &=0, & \mathcal{M}(η_tη_s) &= 0,
      & \mathcal{M}(η_tη_s^\ast) &= α(t-s).
  \end{aligned}
\end{equation}

The statistics of the process follow from interpreting
\cref{eq:projected_single} in a Monte-Carlo sense and thus reduced
system state may then be recovered by averaging over all trajectories
\begin{equation}
  \label{eq:recover_rho}
  ρ_{\sys}(t) = \tr_{\bath}\bqty{\ketbra{ψ(t)}} =
 ∫{\frac{\dd{\vb{z}}}{π^{N}}\eu^{-\abs{\vb{z}}^2}}\ketbra{ψ(t,\vb{z})}{ψ(t,\vb{z}^\ast)}=
  \mathcal{M}_{η_{t}^\ast}\bqty{ψ_t(η_t)^\dag ψ_t(η^\ast_t)}.
\end{equation}

Note that the BCF \(α\) is usually defined as Fourier transform of the
spectral density
\begin{equation}
  \label{eq:specdens}
  J(ω) = {π} ∑_λ \abs{g_λ}^2 δ(ω-ω_λ).
\end{equation}
One then usually performs a continuum limit so that \(J(ω)\) becomes
``smeared out'' to a smooth function and \(α(τ)\) decays to zero for
\(τ\rightarrow ∞\).

We have found that indeed we can treat an infinite environment with a
stochastic differential equation in which only objects of system
dimension appear. Note also, that we can treat explicit time
dependence of \(L\) and \(H\) without alteration to
\cref{eq:nmqsd_single}. The functional \(ψ(η_{t}^\ast)\) is
essentially the state of the system relative to some coherent bath
state, encoded in the value of the stochastic process.


The equation \cref{eq:nmqsd_single} does not preserve the norm of the
state, leading to suboptimal convergence of \cref{eq:recover_rho}.
When recovering the system state, we would like to average of
normalized states
\begin{equation}
  \label{eq:norm_av}
  ρ_{\sys}(t) =
 ∫{\frac{\dd{\vb{z}}}{π^{N}}\eu^{-\abs{\vb{z}}^2}}
 \braket{ψ(t,\vb{z})}{ψ(t,\vb{z}^\ast)} \frac{\ketbra{ψ(t,\vb{z})}{ψ(t,\vb{z}^\ast)}}{\braket{ψ(t,\vb{z})}{ψ(t,\vb{z}^\ast)}}.
\end{equation}

This can be achieved by using a co-moving shifted stochastic process
\begin{equation}
  \label{eq:shifted_proc}
  \tilde{η}_{t}^\ast= η^\ast_{t} + ∫_{0}^{t}\dd{s} α^\ast(t-s) \ev{L^\ast}_{s},
\end{equation}
where
\(\ev{L^\dag}_{t}=ψ(\tilde{η}_{t}^\ast)_{t}^\dag L^\dag
ψ(\tilde{η}_{t}^\ast)_{t}\). The origin of this shift lies in the
study of the Husimi \(Q\) function of the bath
\(Q_{t}(\vb{z}, \vb{z}^\ast) = \eu^{-\abs{z}^{2}} π^{-N}
\braket{ψ(t,\vb{z})}{ψ(t,\vb{z}^\ast)}\). Shifting the process, or on
a deeper level the stochastic state labels, amounts to importance
sampling for each time step.

This leads to the nonlinear NMQSD equation
\begin{equation}
  \label{eq:nmqsd_nonlin_single}
  ∂_tψ_t(η^\ast_t) = -\iu H ψ_t(η^\ast_t) +
  L {η}^\ast_tψ_t(\tilde{η}^\ast_t) - \pqty{L^† -\ev{L^\dag}_{t}}∫_0^t\dd{s}α(t-s)\fdv{ψ_t({η}^\ast_t)}{\tilde{η}^\ast_s}.
\end{equation}
There is a subtlety concerning the functional derivative that won't be
discussed here, but in \cref{sec:nonlin}.
Crucially, the system state is now recovered through
\begin{equation}
  \label{eq:recover_rho_nonlinear}
  ρ_{\sys}(t) = \mathcal{M}_{\tilde{η}_{t}^\ast}\bqty{\frac{ψ_t(\tilde{η}_t)^\dag ψ_t(\tilde{η}^\ast_t)}{\norm{ψ_t(\tilde{η}_t)}^{2}}},
\end{equation}
so that all trajectories contribute with ``equal weight''.

\section{The Hierarchy of Pure States}
\label{sec:hops_basics}
The equation \cref{eq:nmqsd_single} has removed the bath degrees of
freedom from explicit consideration, replacing them with a Gaussian
stochastic process and a rather complicated term containing a memory
integral and a functional derivative
\begin{equation}
  \label{eq:complicated_term}
  ∫_0^t\dd{s}α(t-s)\fdv{ψ_t({η}^\ast_t)}{η^\ast_s}.
\end{equation}

There exist analytical approaches to this
term~\cite{Diosi1998Mar,Strunz2001Habil}, but we keep the approach as
general as possible and instead choose a numerical avenue.

They key~\cite{Suess2014Oct,Hartmann2017Dec,RichardDiss} is define
away the complicated term containing the functional derivative as an
auxiliary state. Expanding the BCF into exponentials
\(α(τ)=∑_{μ}G_{μ=1}^{M}\eu^{-W_{μ}τ}\) and defining
\begin{equation}
  \label{eq:d_op_one}
  D_{μ}(t)\equiv ∫_{0}^{t} G_{μ} \eu^{-W_{μ}(t-s)} \fdv{η^\ast_s},\; D^{\vb{k}}(t)\equiv Π_{μ=1}^{M}\sqrt{\frac{k_{μ}!}{G_{μ}^{k_{μ}}}}
  \frac{1}{i^{k_{μ}}}\pqty{D_{μ}}^{k_{μ}}
\end{equation}
we can define the \(\vb{k}th\) hierarchy state
\begin{equation}
  \label{eq:d_op_hier}
   ψ^{\vb{k}}\equiv D^{\vb{k}}ψ.
\end{equation}

For this state the following equation of motion can be derived
\begin{equation}
  \label{eq:singlehops}\tag{HOPS}
  \dot{ψ}^{\vb{k}} = \qty[-\iu H_\sys + \vb{L}\cdot\vb{η}^\ast -
  ∑_{μ=1}^{M}k_{μ}W_μ]ψ^{\vb{k}} +
  \iu ∑_{μ=1}^{M}\sqrt{G_μ}\qty[\sqrt{k_{μ}}  L ψ^{\vb{k} -
    \vb{e}_{μ}} + \sqrt{\qty(k_{μ} + 1)}  L^† ψ^{\vb{k} +
    \vb{e}_{μ}} ],
\end{equation}
where \(\vb{k}=(k_{1}, k_{2}, \ldots, k_{M})\) with \(k_{μ}\geq 0\) is
a multi index an \(\pqty{\vb{e}_{μ}}_{ν} = δ_{μ,ν}\). The term
\({\vb{k} - \vb{e}_{μ}}\) is evaluated only if \(k_{μ}\geq 1\). We
call \(\abs{\vb{k}}=∑_{μ}k_{μ}\) the hierarchy level of
\(ψ^{\vb{k}}\). The state \(ψ\equiv ψ^{\vb{0}}\) corresponds to the
trajectory obeying \cref{eq:nmqsd_single}.


We call \cref{eq:singlehops} the \emph{Hierarchy of Pure States}
because each hierarchy state couples only to the hierarchy states one
level above and one level below. This is similar to the
\emph{Hierarchical Equations of Motion} (HEOM) approach used
in~\cite{Kato2016Dec}, but with the advantage of reducing the
dimensionality from \(\dim{\hilb_{\sys}}^{2}\) to
\(\dim{\hilb_{\sys}}\) by treating pure states instead of density
matrices.

By truncating the hierarchy we obtain from \cref{eq:singlehops} a
linear differential equation that can be solved numerically. By
choosing a suitable cutoff the method can be made arbitrarily
exact.

Note that the hierarchy states have no physical interpretation, but
can be thought of as the ``memory'' of the system. We will find in
\cref{chap:flow} that they can be of use beyond the mere calculation
of \(ψ=ψ^{\vb{0}}\).

The nonlinear NMQSD \cref{eq:nmqsd_nonlin_single} can be accommodated
in much the same way, except for the replacements
\(L^\dag\rightarrow \pqty{L^\dag-\ev{L^\dag}_{t}}\) and
\(η\rightarrow \tilde{η}\) in \cref{eq:singlehops}. Throughout this
work, the nonlinear method is being used, as it offers much superior
convergence.
